<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta charset="utf-8" />
    <script type="text/javascript">

        class Shape {
            constructor(object) {
                this.position = new Position(0, 0);
                this.name = 'Shape';
                mapProperty(object, this);
            }

            get isShapeObject() {
                return true;
            }
        }
        class Rect extends Shape {
            constructor(object) {
                super(null);
                this.height = 0;
                this.width = 0;
                mapProperty(object, this);
            }
        }

        class Square extends Rect {
            constructor(obj) {
                super(obj);
                this.height = this.width;
                this.name = 'Square';
                console.log(this.position.x, this.position.y, this.name);
            }
        }
        class Position {
            constructor(x, y) {
                this.x = x; this.y = y;

            }
        }
        ///Mapping property from json object
        function mapProperty(propertyArray, object) {
            if (propertyArray == null)
                return;
            if (typeof (object) == "object") {
                for (var key in object) {
                    if (object.hasOwnProperty(key)) {
                        if (typeof (object[key]) == 'object') {
                            if (propertyArray[key] != undefined && typeof (propertyArray[key]) == 'object') {
                                mapProperty(propertyArray[key], object[key]);
                            }
                        }
                        else {
                            object[key] = propertyArray[key];
                        }
                    }
                }
            }
        }


        class DrawBase {
            //constructor(shape) {
            //    if (typeof (shape) != 'object') {
            //        console.log('Doh! it \'s not objecy');
            //        throw new DOMException();
            //    }
            //    else if (shape.isShapeObject == undefined || shape.isShapeObject != true) {
            //        console.log('this is not valid shape')
            //        throw new DOMException();
            //    }
            //    else {
            //        this.Shape = shape;
            //    }
            //}
            get isDrawObject() {
                return true;
            }
            draw(svg,shape) { }
        }

        class SVGDraw extends DrawBase {
            //constructor(shape) {
            //    super(shape);

            //}

            draw(svg,shape) {
                if(svg == undefined || svg == null)
                 svg = new HtmlDomElement('svg', "http://www.w3.org/2000/svg");
                svg.addAttr('width', 320);
                svg.addAttr('height', 320);

                var rect = new HtmlDomElement('rect', "http://www.w3.org/2000/svg");
                rect.addAttr('x', shape.position.x);
                rect.addAttr('y', shape.position.y);
                rect.addAttr('width', shape.width);
                rect.addAttr('height', shape.height);

                rect.addAttr('fill', '#95B3D7');

                svg.appendChild(rect);
                document.body.appendChild(svg.elem);
                return svg;
            }

        }
        function HtmlDomElement(tag, namespace) {
            this.elem = namespace.length > 1
                ? document.createElementNS("http://www.w3.org/2000/svg", tag)
                : document.createElement(tag);
            this.addAttr = function (key, value) {
                var _atr = document.createAttribute(key);
                _atr.value = value;
                this.elem.setAttributeNode(_atr);
            }
            this.appendChild = function (e) {

                this.elem.appendChild(e.elem);
            }

        }


        class graphicsBase {
            constructor(shape, drawBase) {
                if (typeof (shape) != 'object') {
                    console.log('Doh! it \'s not objecy');
                    throw new DOMException();
                }
                else if (shape.isShapeObject == undefined || shape.isShapeObject != true) {
                    console.log('this is not valid shape')
                    throw new DOMException();
                }
                else {
                    this.Shape = shape;
                }

                if (typeof (drawBase) != 'object') {
                    console.log('Doh! it \'s not draw');
                    throw new DOMException();
                }
                else if (drawBase.isDrawObject == undefined || drawBase.isDrawObject != true) {
                    console.log('this is not valid draw provider')
                    throw new DOMException();
                }
                else {
                    this.Drawing = drawBase;
                }
            }

            paint() {
                this.Drawing.draw(null, this.Shape);
            }
        }

    </script>
</head>
<body>
    <!--<svg width="120" height="120"
             viewBox="120 120 120 120"
             xmlns="http://www.w3.org/2000/svg">


        <circle cx="50" cy="50" r="5" stroke="black" stroke-width="0" fill="bkack"></circle>
    </svg>-->
    <script type="text/javascript">
        var x = new Square({ name: 'Rect', position: { x: 10, y: 24 }, width: 60, height: 90 });
        var y = new Rect({ name: 'Rect', position: { x: 10, y: 90 }, width: 60, height: 90 });

        
        var dx = new SVGDraw(x);
        var gx= new graphicsBase(y, dx);
        gx.paint();
       //var xvg = dx.draw();
       // var dy = new SVGDraw(y);
       // dy.draw(xvg);
    </script>

    
    
</body>
</html>
